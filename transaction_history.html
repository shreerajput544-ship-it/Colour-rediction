<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transaction History</title>
<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family: 'Segoe UI', sans-serif;
}
body{
  background:#f5f5f5;
}
.header{
  background:linear-gradient(135deg,#ff6a6a,#ff9a9a);
  padding:20px;
  color:#fff;
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 18px;
  font-weight: bold;
}
.list{
  margin: 15px;
  background: #fff;
  border-radius: 15px;
  overflow: hidden;
}
.list-item{
  padding: 15px;
  border-bottom: 1px solid #eee;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.list-item:last-child{ border-bottom: none; }
.tx-info div:first-child { font-weight: bold; font-size: 15px; margin-bottom: 4px; }
.tx-info div:nth-child(2) { font-size: 12px; color: #666; margin-bottom: 2px; }
.tx-info div:last-child { font-size: 11px; color: #999; }
.tx-amount { font-weight: bold; font-size: 16px; }
.plus { color: #2ecc71; }
.minus { color: #e74c3c; }
</style>
</head>
<body>

<div class="header">
  <span onclick="window.history.back()" style="cursor:pointer;">←</span>
  <span>Transaction History</span>
  <span style="width:20px;"></span>
</div>

<div class="list" id="txList">
  <!-- Transactions will be loaded here -->
</div>

<script>
  const list = document.getElementById('txList');
  let txs = JSON.parse(localStorage.getItem('winmore_transactions') || '[]');
  
  // Filter Logic
  const urlParams = new URLSearchParams(window.location.search);
  const filter = urlParams.get('filter');
  if(filter) {
      document.querySelector('.header span:nth-child(2)').innerText = filter + " History";
      txs = txs.filter(t => t.type === filter);
  }
  
  if(txs.length === 0) {
      list.innerHTML = '<div style="padding:20px; text-align:center; color:#888;">No transactions found.</div>';
  } else {
      txs.forEach(t => {
          let isPositive = t.amount > 0;
          let colorClass = isPositive ? 'plus' : 'minus';
          let sign = isPositive ? '+' : '';
          
          // Format status color
          let statusColor = t.status === 'Pending' ? '#f39c12' : (t.status === 'Win' || t.status === 'Success' ? '#2ecc71' : '#e74c3c');

          let item = document.createElement('div');
          item.className = 'list-item';
          item.innerHTML = `
            <div class="tx-info">
                <div>${t.type} <span style="font-size:11px; color:${statusColor}; border:1px solid ${statusColor}; padding:1px 4px; border-radius:4px;">${t.status}</span></div>
                <div>${t.desc}</div>
                <div>${t.date}</div>
            </div>
            <div class="tx-amount ${colorClass}">${sign}₹${Math.abs(t.amount)}</div>
          `;
          list.appendChild(item);
      });
  }
</script>

</body>
</html>